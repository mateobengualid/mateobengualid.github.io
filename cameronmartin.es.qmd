# Espacios de Cameron-Martin

Uf, demasiada álgebra. Pero necesitábamos introducir espacios vectoriales de dimensión infinita para entender qué es un espacio de Cameron-Martin. Como antes, tomaremos inspiración de @lunardi_miranda_pallara, que tiene un mayor rior matemático, pero que no dudaremos en abandonar en favor de claridad pedagógica. La brecha es bastante grande, y eso se ve al navegar los artículos de Wikipedia sobre el Cálculo de Malliavin, la cantidad de conceptos que hacen falta aprender para entender una oración es difícil. Con suerte, esto dará suficiente información sobre el espacio de Cameron-Martin para continuar con la derivada de Malliavin directamente.

## Medidas gaussianas

Mencionamos en el capítulo anterior que resolveríamos el problema de calcular la longitud y la distancia de vectores de dimensión infinita (en particular, funciones) cambiando la medida de Lebesgue por la medida gaussiana. Hay otra razón para esa elección, resumida en @folk_claim_lebesgue. La medida de Lebesgue es la única medida en espacios de dimensión finita que es:

-   Localmente finita, es decir, un conjunto alrededor de un punto tiene una medida finita. $\lambda(N_x) < +\infty$
-   Invariante a traslaciones, es decir, mover un conjunto en una determinada dirección $d$ mantiene intacto el valor de la medida. $\lambda(\{N_x\}=\lambda(\{N_x "+" d\})$
-   Estrictamente positiva, es decir, si $A \neq \emptyset$, entonces $\lambda(A)>0$

Para dimensiones infinitas, no hay equivalente[^cameronmartin.es-1], y la medida localmente finita e invariante a la traslación es la medida trivial $\mu(A)=0, \forall A$ .

[^cameronmartin.es-1]: Estrictamente hablando, existe un análogo para dimensiones infinitas, pero el espacio vectorial debe ser *no separable* y la medida no será sigma-finita. Los espacios con los que tratamos normalmente son separables. En particular, los espacios de Hilbert (espacios con productos internos que son completos bajo la métrica inducida por el producto interno) son separables si tienen una base ortonormal en $\mathbb{N}$ (siendo potencialmente infinita).

Debido a esto, pasamos a usar la medida gaussiana, que tiene colas con decaimiento exponencial y pueden aplastar los valores de la función si están muy lejos del centro[^cameronmartin.es-2]. Esto también significa que tenemos que abordar *otros* problemas. En particular, el hecho de que no es invariante a la traslación.

[^cameronmartin.es-2]: Esto es una consecuencia del teorema de Fernique

## (In)variancia de la traslación

Para ilustrar mejor este problema, supongamos una integral de Riemann como la siguiente:

$$
\int_{-\infty}^{+\infty}f(x)dx
$$

A continuación, hacemos un cambio de variable debido a una traslación $x \rightarrow x +h$. El área bajo la curva no habrá cambiado, solo se habrá desplazado hacia un lado:

$$
\int_{-\infty}^{+\infty}f(x)dx = \int_{-\infty}^{+\infty}f(x+h)dx
$$

Esto está respaldado por la medida de Lebesgue subyacente, que también es invariante bajo una translación arbitraria:

$$
\lambda([a+h,b+h])=(b-h)-(a-h)=b-a=\lambda([a,b])
$$

Y finalmente se confirma visualmente. Mirá estas funciones con forma de fantasmas. Independientemente del cambio, tienen la misma área bajo la curva:

```{r}
library(ggplot2)

h <- 0.001
steps = 1 / h
x <- seq(from = -5, to = 10, length.out=steps)
y_1 <- dnorm(x) + 0.25 * dnorm(x, mean=-3, sd = 0.5)
y_plus_h <- dnorm(x, mean = 5) + 0.25 * dnorm(x, mean=2, sd = 0.5)

df <- data.frame(
  time=x,
  density_y=y_1,
  density_y_plus=y_plus_h
)

# ggplot(data = df, mapping = aes(time)) +
#   geom_area(mapping = aes(y=density_y, color="green"), alpha = 0.5, show.legend = FALSE) +
#   geom_area(mapping = aes(y=density_y_plus), alpha = 0.5, show.legend = FALSE)
ggplot(data = df, mapping = aes(x=time), legend=TRUE) +
  xlim(-5, 10) +
  xlab('X') +
  ylab('f(X)') +
  geom_area(mapping = aes(y=density_y, fill="f(X)"), alpha = 0.3) +
  geom_area(mapping = aes(y=density_y_plus, fill="f(X+5)"), alpha = 0.5) +
  scale_fill_manual("Funciones",values=c("green", "blue"))
```

Desafortunadamente, la medida gaussiana no permite esto. Recordemos los casos n-dimensionales o unidimensionales para una medida gaussiana centrada y estándar.

$$
\begin{aligned}
\gamma^{n}(A) &= \frac{1}{({2 \pi})^{n/2}} \int_{A} \exp \left( - \frac{1}{2} \| x \|_{\mathbb{R}^{n}}^{2} \right) \, \mathrm{d} \lambda^{n} (x) \\
\gamma(A) &= \frac{1}{\sqrt{2 \pi}} \int_{A} \exp \left( - \frac{1}{2} x^{2} \right) \, \mathrm{d} \lambda (x)
\end{aligned}
$$

Usemos la medida gaussiana (o con un factor de ponderación) para las funciones anteriores y veamos cómo modifican el área bajo ambas funciones:

```{r}
library(ggplot2)
h <- 0.001
steps = 1 / h
x <- seq(from = -5, to = 10, length.out=steps)
weight <- dnorm(x)
y <- dnorm(x) + 0.25 * dnorm(x, mean=-3, sd = 0.5)
y_weighted <- y * weight
y_plus_h <- dnorm(x, mean = 5) + 0.25 * dnorm(x, mean=2, sd = 0.5)
y_plus_h_weighted <- y_plus_h * weight

df <- data.frame(
  time=x,
  density_y=y_1,
  density_y_plus=y_plus_h,
  weight=weight
)

ggplot(data = df, mapping = aes(x=time), legend=TRUE) +
  xlim(-5, 10) +
  xlab('X') +
  ylab('f(X)') +
  geom_area(mapping = aes(y=y_weighted, fill="f(X)"), alpha = 0.3) +
  geom_area(mapping = aes(y=y_plus_h_weighted, fill="f(X+5)"), alpha = 0.5) + 
  geom_line(mapping = aes(y=weight, colour="Weight"),linetype = 2) + 
  scale_fill_manual("Funciones",values=c("green", "blue")) + 
  scale_colour_manual("",values=c("black"),labels=c("Ponderación"))
  #theme(legend.position = "none")
```

Como se puede ver, la primera función tenía mucha área en el medio del ponderador, por lo que la conserva bastante. La función desplazada, en cambio, se ha achicado. Ahora bien, aunque el área ha cambiado, en teoría podríamos recuperar el factor por el cual ha cambiado. Esto es fácil de calcular con dimensiones finitas, pero es desafiante o imposible en dimensiones infinitas.

La idea fundamental es que *se puede* realizar una traslación en dimensiones infinitas y llegar a un cálculo. El único requisito es que la traslación sea por un vector que provenga de un espacio "más pequeño", el espacio de **Cameron-Martin**, y solo esas traslaciones tienen sentido y están permitidas.

## El espacio de Cameron-Martin

Aunque suene misterioso, en realidad es bastante sencillo y se puede seguir el enfoque de @cameron_martin_theorem y @lunardi_miranda_pallara. Regresemos al producto interno en lugar de usar la norma para entender qué está pasando, y usaremos un espacio finito de $n$ dimensiones para ejemplificar:

$$
\gamma^{n}(A) = \frac{1}{({2 \pi})^{n/2}} \int_{A} \exp \left( - \frac{1}{2} \langle x,x \rangle_{\mathbb{R}^{n}} \right) \, dx
$$

Ahora bien, podemos reemplazar $A$ con una $A-h$ desplazada y ver qué sucede:

$$
\begin{aligned}
\gamma^{n}(A-h) &= \frac{1}{({2 \pi})^{n/2}} \int_{A} \exp \left( - \frac{1}{2} \langle x-h,x-h \rangle_{\mathbb{R}^{n}} \right) \, dx \\ 
&= \frac{1}{({2 \pi})^{n/2}} \int_{A} \exp \left( - \frac{1}{2} \langle x,x \rangle_{\mathbb{R}^{n}} \right) * \exp \left( - \frac{1}{2} \left(-2\langle x,h \rangle_{\mathbb{R}^{n}} + \langle h,h \rangle_{\mathbb{R}^{n}}\right) \right)\, dx \\ 
&= \frac{1}{({2 \pi})^{n/2}} \int_{A} \underbrace{\exp \left( - \frac{1}{2} \| x \|^2_{\mathbb{R}^{n}} \right)}_{\text{Medida gaussiana}} * \underbrace{\exp \left(  \langle x,h \rangle_{\mathbb{R}^{n}} - \frac{1}{2} \| h \|^2_{\mathbb{R}^{n}}\right)}_{\text{"Cambio de variable"}} \, dx \\ 
\end{aligned}
$$

Es decir, una medida gaussiana para un conjunto trasladado es la medida del conjunto original, multiplicada por un factor adicional para realizar el "cambio de variable". Ese factor adicional se denomina **derivada de Radon-Nikodym** porque expresa cuánto cambia la medida de un conjunto cuando cambia otra medida. En este caso, transforma la medida gaussiana centrada a la medida gaussiana con una traslación de $h$ y se simboliza con $\frac{\partial(T_h)_*(\gamma)}{d\gamma}(x)$

Recordemos que, si hay un espacio $E$ y una medida $\mu$ que es localmente finita e igual a sí misma después de *cualquier* traslación por "cambio de variables", entonces o bien $E$ es de dimensión finita, como dijimos más arriba, o bien $\mu$ es la medida trivial $\mu(A) = 0,\, \forall A$. Esto ya se puede ver en la expresión anterior, donde si $h$ es de dimensión infinita, entonces existe el potencial de hacer que esta integral tienda a infinito. Afortunadamente para nosotros, también sabemos que podemos evitar problemas si esperamos equivalencia bajo *algunas* traslaciones, es decir, traslaciones que son elementos de un espacio de Cameron-Martin, también llamadas direcciones de Cameron-Martin.

Partimos de un espacio de dimensión infinita $H$, nuestro espacio de Cameron-Martin. Tendremos $h \in H$, con una función $i(h):H\rightarrow E$, y $i(H) \subseteq E$. Estas $i(H)$ serán nuestras direcciones de Cameron-Martin. Impondremos restricciones adicionales a $h$. Para empezar, y basándonos en la derivada de Radon-Nikodym que vemos arriba, necesitamos *al menos* que $\|h\|^2_H < \infty$. Luego, necesitamos decidir qué significa $\langle h, x \rangle$ y qué hacer con esa expresión. De hecho, este no es un verdadero producto interno porque $h \in H$ y $x \in E$ . Acordate, ¡El objetivo de $H$ *es reducir* el espacio vectorial!. En pocas palabras, lo que ocurre con ese falso producto interno es que hay una correspondencia entre cada $h$ y una función en el espacio de funciones $I(h): H \rightarrow L^2$, y $I(h)(x)$ es lo que cuenta como el "producto interno" $\langle h, x \rangle^\sim$. [^cameronmartin.es-3]

[^cameronmartin.es-3]: Esto se llama la integral de Paley-Wiener. No necesitaremos mencionarla ni hacer referencia a ella de nuevo porque concuerda con la integral de Ito cuando ambas están definidas, de forma similar a las medidas de Borel y Lebesgue.

## Ejemplo de un espacio de Cameron-Martin

Todo lo anterior fue bastante árido, así que echemos un vistazo a un ejemplo de un espacio de dimensión infinita y su correspondiente espacio de Cameron-Martin. No intentaré explicar cómo se obtuvo este espacio, hay una derivación bastante larga en @lunardi_miranda_pallara .

### Sucesiones infinitas

¿Te acordás del espacio de sucesiones infinitas? Es un espacio de dimensión infinita y lo denotamos $\mathbb{R}^{\mathbb{N}}:=\mathbb{R}^{\infty}$, con cardinalidad numerable. Ahora, consideremos el espacio de sucesiones que se anulan en el infinito, con el símbolo exótico $\mathbb{R}_c^{\infty}$ y sus elementos tendrán el símbolo aún más exótico $\xi\in\mathbb{R}_c^{\infty}$ . Entonces, por definición, sabemos que $\lim_{k\rightarrow \infty}\xi_k = 0$.

Ahora, establecemos una correspondencia entre estas sucesiones y funciones, muy sencilla: $\xi \rightarrow f, \text{con }f(x) = \sum^\infty_{k=1}\xi_k x_k$ , y la limitaremos a las sumas que sean finitas, es decir $f(x)<\infty$ o $f(x) \in L^2$. Verifiquemos que cuando calculemos la medida para el primer término de esta serie con una medida gaussiana, estaremos simplificando mucho:

$$
\int_X \xi_1 x_1 d\gamma(x_1)=\xi_1 \int_{-\infty}^{+\infty} x_1d\gamma(x_1)=\xi_1 *\mathbb{E}[\mathcal{N}(\mu=0,\sigma^2=1)]=0
$$

Ahora, se puede hacer esto para todos los $x_k$ y encontrar el mismo resultado. Esto no es casualidad, y es la razón por la que utilizamos la medida gaussiana para dimensiones infinitas. De hecho, $\gamma$ para el caso de dimensión infinita tendrá media $\mu=0$ y varianza/covarianza $B_\gamma(\xi,\xi)=\|\xi\|_{\ell^2}$.

Esta última afirmación también es útil porque podemos utilizarla para obtener el valor de la norma de una función con la medida gaussiana. No lo demostraré ahora, pero $\|f\|^2_{L^2(X,\gamma)}=\|\xi\|^2_{\ell^2}$. Ahora, si tomamos una $h\in \mathbb{R}^\infty$, podemos demostrar (pero no lo haremos) que con restringir el espacio de traslaciones para las sucesiones a $h\in H = \ell^2$ , alcanza para que las funciones anteriores siempre tengan una medida. Entonces, el espacio de Cameron-Martin es $\ell^2$.

------------------------------------------------------------------------
